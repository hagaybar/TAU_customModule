"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.readJournalSnapshot = readJournalSnapshot;
exports.readStateSnapshot = readStateSnapshot;
exports.captureRunSnapshot = captureRunSnapshot;
const journal_1 = require("../storage/journal");
const stateCache_1 = require("../runtime/replay/stateCache");
async function readJournalSnapshot(runDir) {
    const events = await (0, journal_1.loadJournal)(runDir);
    return events.map((event) => ({
        seq: event.seq,
        ulid: event.ulid,
        type: event.type,
        recordedAt: event.recordedAt,
        data: event.data,
    }));
}
async function readStateSnapshot(runDir) {
    return (0, stateCache_1.readStateCache)(runDir);
}
async function captureRunSnapshot(runDir) {
    const [journal, state] = await Promise.all([readJournalSnapshot(runDir), readStateSnapshot(runDir)]);
    return { journal, state };
}
