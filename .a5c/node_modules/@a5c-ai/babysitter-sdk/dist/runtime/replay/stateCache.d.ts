import { EffectIndex } from "./effectIndex";
import { EffectStatus } from "../types";
export declare const STATE_CACHE_SCHEMA_VERSION = "2026.01.state-cache";
export interface StateCacheJournalHead {
    seq: number;
    ulid: string;
    checksum?: string;
}
export interface DerivedEffectSummary {
    effectId: string;
    invocationKey: string;
    status: EffectStatus;
    kind?: string;
    label?: string;
    taskId?: string;
    stepId?: string;
    requestedAt?: string;
    resolvedAt?: string;
}
export interface StateCacheSnapshot {
    schemaVersion: string;
    savedAt: string;
    journalHead?: StateCacheJournalHead | null;
    stateVersion: number;
    effectsByInvocation: Record<string, DerivedEffectSummary>;
    pendingEffectsByKind: Record<string, number>;
    rebuildReason?: string | null;
}
export interface CreateStateCacheSnapshotOptions {
    journalHead?: StateCacheJournalHead | null;
    savedAt?: string;
    schemaVersion?: string;
    stateVersion?: number;
    effectsByInvocation?: Record<string, DerivedEffectSummary>;
    pendingEffectsByKind?: Record<string, number>;
    rebuildReason?: string | null;
}
export declare function readStateCache(runDir: string): Promise<StateCacheSnapshot | null>;
export declare function writeStateCache(runDir: string, snapshot: StateCacheSnapshot): Promise<void>;
export declare function journalHeadsEqual(a?: StateCacheJournalHead | null, b?: StateCacheJournalHead | null): boolean;
export declare function createStateCacheSnapshot(journalHeadOrOptions?: StateCacheJournalHead | null | CreateStateCacheSnapshotOptions): StateCacheSnapshot;
export declare function normalizeJournalHead(raw: unknown): StateCacheJournalHead | null | undefined;
export declare function normalizeSnapshot(raw: unknown): StateCacheSnapshot;
export declare function rebuildStateCache(runDir: string, opts?: {
    effectIndex?: EffectIndex;
    reason?: string;
}): Promise<StateCacheSnapshot>;
//# sourceMappingURL=stateCache.d.ts.map